# ===================================================================
# WMS Barcode Scanner - Docker Compose Base Configuration
# ===================================================================
# This is the base configuration shared between dev and prod
# Development: docker-compose up (uses docker-compose.override.yml)
# Production: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up
# ===================================================================

version: '3.8'

services:
  wms-web:
    build:
      context: .
      dockerfile: Dockerfile
    image: wms-barcode-scanner-web:latest
    container_name: wms-web-app

    # Environment variables from .env file
    env_file:
      - .env

    # Ports
    ports:
      - "${FLASK_PORT:-5000}:5000"

    # Volumes
    volumes:
      # Persist logs outside container
      - ./logs:/app/logs

    # Networks
    networks:
      - wms-network

    # Health check
    healthcheck:
      test: ["CMD", "python", "-c", "import requests; requests.get('http://localhost:5000/health', timeout=5)"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

    # Restart policy (can be overridden)
    restart: unless-stopped

networks:
  wms-network:
    driver: bridge
    name: wms-network

# Optional: SQL Server container (uncomment if needed)
# services:
#   mssql:
#     image: mcr.microsoft.com/mssql/server:2022-latest
#     container_name: wms-mssql
#     environment:
#       ACCEPT_EULA: "Y"
#       SA_PASSWORD: "YourStrong@Passw0rd"
#       MSSQL_PID: "Developer"
#     ports:
#       - "1433:1433"
#     volumes:
#       - mssql-data:/var/opt/mssql
#     networks:
#       - wms-network
#     restart: unless-stopped
#
# volumes:
#   mssql-data:
#     name: wms-mssql-data
